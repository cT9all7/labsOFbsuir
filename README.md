# labsOFbsuir

Лабораторная работа No 2. POSIX-совместимая файловая система

Структура ФС, содержимое inode, команды оболочки
Знакомство с POSIX-совместимой файловой системой ‒ opendir(3), readdir(3),
closedir(3), fstat(2), readlink(2), symlink(2), link(2), unlink(2), ...
Задание
Разработать программу dirwalk, сканирующую файловую систему и выводящую в
stdout информацию в соответствии с опциями программы. Формат вывода аналогичен
формату вывода утилиты find.
dirwalk [dir] [options]
dir ‒ начальный каталог. Если опущен, текущий (./).
options ‒ опции.
-l -- только символические ссылки (-type l)
-d -- только каталоги (-type d)
-f -- только файлы (-type f)
-s — сортировать выход в соответствии с LC_COLLATE
Если опции ldf опущены, выводятся каталоги, файлы, ссылки, как у find без
параметров.


Лабораторная работа No 3. Понятие процессов.

Изучение системных вызовов fork(), execve(), getpid(), getppid(), getenv() .
Создаются две программы ‒ parent и child .
Перед запуском программы parent в окружении создается переменная среды
CHILD_PATH с именем каталога, где находится программа child .
Родительский процесс (программа parent ) после запуска получает переменные
среды, сортирует их в LC_COLLATE=C и выводит в stdout . После этого входит в цикл об-
работки нажатий клавиатуры.
Символ « + » порождает дочерний процесс, используя fork() и execve() , запускает
очередной экземпляр программы child ., используя информацию о каталоге из окруже-
ния, которую получает, используя функцию getenv() . Имя программы ( argv[0] ) устанав-
ливается как child_XX , где XX ‒ порядковый номер от 00 до 99. Номер инкрементиру -
ется родителем.
Символ « * » порождает дочерний процесс аналогично предыдущему случаю, одна-
ко информацию о его расположении получает, сканируя массив параметров среды,
переданный в третьем параметре функции main() .
Символ « & » порождает дочерний процесс аналогично предыдущему случаю, одна-
ко информацию о его расположении получает, сканируя массив параметров среды,
указанный в переданный во внешней переменной extern char **environ , установлен-
ной хост-средой при запуске (см. IEEE Std 1003.1-2017).
При запуске дочернего процесса ему передается сокращенное окружение, вклю-
чающее набор переменных, указанных в файле, который передается родительскому
процессу как параметр командной строки. Минимальный набор переменных должен
включать SHELL, HOSTNAME, LOGNAME, HOME, LANG, TERM, USER, LC_COLLATE, PATH.
Дочерний процесс открывает этот файл, считывает имена переменных, получает из
окружения их значение и выводит в stdout .
Дочерний процесс (программа child ) выводит свое имя, pid, ppid, открывает файл
с набором переменных, считывает их имена, получает из окружения, переданного ему
при запуске, их значение способом, указанным при обработке нажатий, выводит в
stdout и завершается.
Символ « & » завершает выполнение родительского процесса.

Программы компилируются с ключами
-W -Wall -Wno-unused-parameter -Wno-unused-variable -std=c11 -pedantic
Для компиляции, сборки и очистки используется make.


Лабораторная работа No 4. Взаимодействие и синхронизация
процессов

Синхронизация процессов с помощью сигналов и обработка сигналов таймера.
Задача — управление дочерними процессами и упорядочение вывода в stdout от
них, используя сигналы SIGUSR1 и SIGUSR2.
Действия родительского процесса
По нажатию клавиши «+» pодительский процесс (P) порождает дочерний процесс
(C_k) и сообщает об этом.
По нажатию клавиши «-» P удаляет последний порожденный C_k, сообщает об
этом и о количестве оставшихся.
При вводе символа «k» P удаляет все C_k и сообщает об этом.
При вводе символа «s» P запрещает всем C_k выводить статистику (см. ниже).
При вводе символа «g» P разрешает всем C_k выводить статистику.
При вводе символов «s<num>» P запрещает C_<num> выводить статистику.
При вводе символов «g<num>» P разрешает C_<num> выводить статистику.
При вводе символов «p<num>» P запрещает всем C_k вывод и запрашивает
C_<num> вывести свою статистику. По истечению заданного времени (5 с, например),
если не введен символ «g», разрешает всем C_k снова выводить статистику.
По нажатию клавиши «q» P удаляет все C_k, сообщает об этом и завершается.
Действия дочернего процесса
Дочерний процесс во внешнем цикле заводит будильник (nanosleep(2)) и входит в
вечный цикл, в котором в режиме чередования заполняет структуру, содержащую пару
переменных типа int, значениями {0, 0} и {1, 1} (см. раздел «Проблемы неатомарного
доступа» темы «Сигналы»).
При получении сигнала от будильника проверяет содержимое структуры, собирает
статистику и повторяет тело внешнего цикла.
Через заданное количество повторений внешнего цикла (например, через 101)
дочерний процесс, если ему разрешено, выводит свои PPID, PID и 4 числа — количество
разных пар, зарегистрированных в момент получения сигнала от будильника.
Вывод осуществляется посимвольно.
C_k запрашивает доступ к stdout у P и осуществляет вывод после подтверждения.
По завершению вывода C_k сообщает P об этом.
Следует подобрать интервал времени ожидания и количество повторений внеш-
него цикла, чтобы статистика была значимой.
